<html><head><meta charset="utf-8" /><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" /><title>9Cards</title><meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="description" content="A launcher crafted for and by Android Power Users" /><meta name="author" content="47deg" /><meta name="og:image" content="/nine-cards-v2/img/poster.png" /><meta name="og:title" content="9Cards" /><meta name="og:site_name" content="9Cards" /><meta name="og:url" content="" /><meta name="og:type" content="website" /><meta name="og:description" content="A launcher crafted for and by Android Power Users" /><meta name="twitter:image" content="/nine-cards-v2/img/poster.png" /><meta name="twitter:card" content="summary_large_image" /><meta name="twitter:site" content="" /><link rel="icon" type="image/png" href="/nine-cards-v2/img/favicon.png" /><link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" /><link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css" /><link rel="stylesheet" href="/nine-cards-v2/highlight/styles/default.css" /><link rel="stylesheet" href="/nine-cards-v2/css/style.css" /><link rel="stylesheet" href="/nine-cards-v2/css/palette.css" /><link rel="stylesheet" href="/nine-cards-v2/css/custom.css" /></head><body class="docs"><div id="wrapper"><div id="sidebar-wrapper"><ul id="sidebar" class="sidebar-nav"><li class="sidebar-brand"><a href="/nine-cards-v2/" class="brand"><div class="brand-wrapper" style="background:url('/nine-cards-v2/img/sidebar_brand.png') no-repeat"><span>9Cards</span></div></a></li> <li><a href="/nine-cards-v2/docs/index.html" class="">Introduction</a></li> <li><a href="/nine-cards-v2/docs/Libraries.html" class="">Libraries</a></li> <li><a href="/nine-cards-v2/docs/Client.html" class="">Client</a> <ul class="sub_section"> <li><a href="/nine-cards-v2/docs/client/Installation.html" class="">Install Client</a></li> <li><a href="/nine-cards-v2/docs/client/Architecture.html" class="">Client Architecture</a></li> <li><a href="/nine-cards-v2/docs/client/Database.html" class="">Database</a></li> <li><a href="/nine-cards-v2/docs/client/CloudStorage.html" class="">Cloud Storage</a></li></ul></li> <li><a href="/nine-cards-v2/docs/Server.html" class="">Server</a> <ul class="sub_section"> <li><a href="/nine-cards-v2/docs/server/Installation.html" class="">Install Server</a></li> <li><a href="/nine-cards-v2/docs/server/Architecture.html" class="">Server Architecture</a></li> <li><a href="/nine-cards-v2/docs/server/Ednpoints.html" class=" active ">Endpoints</a></li> <li><a href="/nine-cards-v2/docs/server/Authentication.html" class="">Authentication</a></li> <li><a href="/nine-cards-v2/docs/server/Cache.html" class="">Cache</a></li></ul></li></ul></div><div id="page-content-wrapper"><div class="nav"><div class="container-fluid"><div class="row"><div class="col-lg-12"><div class="action-menu pull-left clearfix"><a href="#menu-toggle" id="menu-toggle"><i class="fa fa-bars" aria-hidden="true"></i></a></div><ul class="pull-right"><li class="hidden-xs"><a href="https://github.com/47deg/nine-cards-v2"><i class="fa fa-eye"></i><span>WATCH<span id="eyes" class="label label-default">--</span></span></a></li><li class="hidden-xs"><a href="https://github.com/47deg/nine-cards-v2"><i class="fa fa-star-o"></i><span>STARS<span id="stars" class="label label-default">--</span></span></a></li><li><a href="#" onclick="shareSiteTwitter('9Cards A launcher crafted for and by Android Power Users');"><i class="fa fa-twitter"></i></a></li><li><a href="#" onclick="shareSiteFacebook('9Cards A launcher crafted for and by Android Power Users');"><i class="fa fa-facebook"></i></a></li><li><a href="#" onclick="shareSiteGoogle();"><i class="fa fa-google-plus"></i></a></li></ul></div></div></div></div><div id="content" data-github-owner="47deg" data-github-repo="nine-cards-v2"><div class="content-wrapper"><section><h1 id="9-cards-backend-v2-list-of-endpoints">9 Cards Backend V2: List of Endpoints</h1>

<p>This file gives a description of the endpoints in the 9 Cards Backend API.
The 9 Cards Backend is a server-side HTTP/REST application, which supports the
actions of the <a href="https://github.com/47deg/nine-cards-v2">9 Cards launcher</a>,
provides it with needed information, and implements the communication across
several clients through the use of shared collections.</p>

<!-- markdown-toc start - Don't edit this section. Run M-x markdown-toc-generate-toc again -->
<p><strong>Table of Contents</strong></p>

<ul>
  <li><a href="#ninecards-backend-v2-list-of-endpoints">9 Cards Backend V2, List of Endpoints</a>
    <ul>
      <li><a href="#glossary">Glossary</a></li>
      <li><a href="#headers">Headers</a>
        <ul>
          <li><a href="#client-authentication-headers">Client Authentication Headers</a>
            <ul>
              <li><a href="#client-authentication-failure">Client Authentication failure</a></li>
              <li><a href="#google-play-token-header">Google Play Token Header</a></li>
            </ul>
          </li>
        </ul>
      </li>
      <li><a href="#body-entity-objects">Body Entity Objects</a>
        <ul>
          <li><a href="#application-cards">Application Cards</a></li>
          <li><a href="#shared-collection-card">Shared Collection Card</a></li>
          <li><a href="#shared-collection-list">Shared Collection List</a></li>
        </ul>
      </li>
      <li><a href="#endpoints">Endpoints</a>
        <ul>
          <li><a href="#users-and-installations">Users and installations</a>
            <ul>
              <li><a href="#user-signup">User Signup</a></li>
              <li><a href="#update-an-installation">Update an installation</a></li>
            </ul>
          </li>
          <li><a href="#application-endpoints">Application endpoints</a>
            <ul>
              <li><a href="#categorize-apps">Categorize apps</a></li>
              <li><a href="#get-apps-details">Get Apps Details</a></li>
              <li><a href="#get-ranking-of-applications">Rank Applications</a></li>
            </ul>
          </li>
          <li><a href="#recommendation-endpoints">Recommendation Endpoints</a>
            <ul>
              <li><a href="#recommend-by-list-of-apps">Recommend by list of apps</a></li>
              <li><a href="#recommend-by-category">Recommend by category</a></li>
            </ul>
          </li>
          <li><a href="#collection-endpoints">Collection endpoints</a>
            <ul>
              <li><a href="#publish-a-shared-collection">Publish a shared collection</a></li>
              <li><a href="#read-a-collection">Read a collection</a></li>
              <li><a href="#edit-a-collection">Edit a collection</a></li>
              <li><a href="#collections-published-by-user">Collections published by user</a></li>
              <li><a href="#list-of-collections-by-category">List of collections by category</a></li>
            </ul>
          </li>
          <li><a href="#subscription-endpoints">Subscription endpoints</a>
            <ul>
              <li><a href="#list-of-subscribed-collections">List of subscribed collections</a></li>
              <li><a href="#subscribe-to-a-shared-collection">Subscribe to a shared collection</a></li>
              <li><a href="#unsubscribe-from-a-shared-collection">Unsubscribe from a shared collection</a></li>
            </ul>
          </li>
          <li><a href="#rankings-endpoints">Rankings Endpoints</a>
            <ul>
              <li><a href="#read-a-ranking">Read a Ranking</a></li>
              <li><a href="#refresh-a-ranking">Refresh a Ranking</a></li>
            </ul>
          </li>
        </ul>
      </li>
    </ul>
  </li>
</ul>

<!-- markdown-toc end -->

<h2 id="glossary">Glossary</h2>

<p>The headers and data fields within the backend server refer to several concepts of the
application’s domain, involving the Google Play Store for Android applications.</p>

<ul>
  <li>An <strong>Android user</strong> is a user account on the Android platform, which may be within
one or more Android devices. The user account is identified with an email address.</li>
  <li>An <strong>Android ID</strong> is a globally unique ID, issued for each device running Android.</li>
  <li>A <strong>client</strong> refers to both the Android user account and the Android Id of a device
running the <a href="https://github.com/47deg/nine-cards-v2">9 Cards launcher</a>.</li>
  <li>A <strong>device token</strong> identifies a notification mailbox, unique for each client (user account and device).
The backend uses the device token to notify a client of any updates to a public collection they’re subscribed to. This is done through <a href="https://firebase.google.com/">Firebase notification API</a>.
Note that a <em>client</em> may have no <em>device token</em> associated with it.</li>
  <li>A <strong>package name</strong> (or <em>package</em> for short) is a unique identifier for each Android app.
The syntax of package names is like that of Java packages. It is a dot-separated sequence of
one or more segments, where each segment is a lowercase word.
For instance, the <a href="https://play.google.com/store/apps/details?id=com.google.android.youtube">YouTube app</a>
has <code class="highlighter-rouge">com.google.android.youtube</code> as its package name.</li>
  <li>A <strong>category</strong> within the Google Play Store is a name for a group of applications that solve
similar needs. Syntactically, a category is a list of underscore-separated upper-case words,
such as <code class="highlighter-rouge">SOCIAL</code> or <code class="highlighter-rouge">GAME_ACTION</code>.
Categories are not exclusive so an app may belong to several categories.</li>
</ul>

<h2 id="headers">Headers</h2>

<p>The Backend API requires in its request, some standard or non-standard request headers.
We group these headers depending on the purpose they are used for.</p>

<h4 id="standard-headers">Standard Headers</h4>

<p>All of the endpoints in this API that require either a body entity in the request
or provide one in the response, use <a href="https://tools.ietf.org/html/rfc7159">JSON</a> for serialization.
Those endpoints will need the following standard content negotiation headers
 <code class="highlighter-rouge">Content-Type</code> (for the request) and <code class="highlighter-rouge">Accept</code> (for the response), with the value
 <code class="highlighter-rouge">application/json</code> in both headers.</p>

<h4 id="client-authentication-headers">Client Authentication Headers</h4>

<p>These headers are used to authenticate the sender, and to identify the user account
and the Android device that corresponds to this server.</p>

<ul>
  <li><code class="highlighter-rouge">X-Android-ID</code>: should give the Android Id of the client’s device. Note that, since the
process in the signup involves a user and device, not only the user but the device as well should be signed up beforehand.</li>
  <li><code class="highlighter-rouge">X-Session-Token</code>: should carry the user’s <code class="highlighter-rouge">sessionToken</code> that the backend generated and gave to the client
in Step 3 of the signup process (see the README).
This value acts as a way to identify the user within the backend.</li>
  <li><code class="highlighter-rouge">X-Auth-Token</code>: the <a href="https://en.wikipedia.org/wiki/Hash-based_message_authentication_code">Hash-based message authentication code</a>,
used for authenticating the request. It ensures that the client using the <code class="highlighter-rouge">sessionToken</code> is the one that is acting for that user.</li>
</ul>

<p>You can find more details about these headers in the <code class="highlighter-rouge">README</code>.</p>

<h5 id="client-authentication-failure">Client Authentication failure</h5>
<p>Most endpoints in the backend API require the client authentication headers,
to identify the sender as a client, on whose account the endpoint operates.
Those endpoints fail with a <code class="highlighter-rouge">401 Unauthorized</code> status code if
<em>a)</em> any of the authentication headers are missing; or
<em>b)</em> the <code class="highlighter-rouge">X-Session-Token</code> or the <code class="highlighter-rouge">X-Android-ID</code> do not correspond to a client signed up in the backend; or
<em>c)</em> the <code class="highlighter-rouge">X-Auth-Token</code> does not correspond with the result of hashing the request URL
    with the API key that the backend gave that client.</p>

<h4 id="google-play-token-header">Google Play Token Header</h4>

<p>The Google Play API is the main source of information on Android apps,
and the backend uses it to issue requests to those APIs on behalf of the user.
The header <code class="highlighter-rouge">X-Google-Play-Token</code> is used to pass an access token for the Google Play API,
which is issued by this API to each client.
Access to this API may sometimes fail because the given token is unauthorized or expired.
It may also fail if the request quota for that token is exhausted.</p>

<p>Although the Google Play API is the main source of information, the backend uses a
cache to store any information it has already fetched, and it sometimes uses
the public <a href="https://play.google.com/store/">web page of Play Store</a> to retrieve it.
For this reason, the endpoints generally do not inform if the <code class="highlighter-rouge">X-Google-Play-Token</code>
is unauthorized, or its quota is expired. They do, however, return a <code class="highlighter-rouge">401 Unauthorized</code>
response status code if this header is missing.</p>

<p>Along with this header, it is possible to use the optional header <code class="highlighter-rouge">X-Android-Market-Localization</code>.
This one is used to identify the localization, language, and availability,
for which the information about each Android App should be fetched.
Values for this header are <a href="https://tools.ietf.org/html/bcp47">BCP-47 codes</a>, such as <code class="highlighter-rouge">en-US</code> or <code class="highlighter-rouge">es-ES</code>.</p>

<h2 id="body-entity-objects">Body Entity Objects</h2>

<p>All of the body entities passed by the endpoints of this API, be it as requests or responses,
are encoded in <a href="https://tools.ietf.org/html/rfc7159">JSON</a>.
When describing the entities, we use the names of types and constants as specified in the standard,
for example <em>object</em> means <a href="https://tools.ietf.org/html/rfc7159#section-4">JSON Object</a>.</p>

<h3 id="application-cards">Application Cards</h3>

<p>An application card is a set of information about an Android app, that the backend fetches and gives back.
The information of an application card is provided by Google’s Play store, either through its API or its web page.
The backend does not edit such information, only fetches it and stores it in a cache.
The fields in an application card object are usually some, or all of these:</p>
<ul>
  <li><code class="highlighter-rouge">packageName</code>: a string with the <em>package name</em> of the application.</li>
  <li><code class="highlighter-rouge">title</code>: a string with a human-readable name of the app.</li>
  <li><code class="highlighter-rouge">categories</code>: a list of strings, which are the <em>categories</em> in which the app is listed.
These categories are usually sorted from greater to lesser <em>relevance</em> to the app.</li>
  <li><code class="highlighter-rouge">category</code>: a string that gives the <em>first</em> (thus most relevant) category the app is associated with.</li>
  <li><code class="highlighter-rouge">free</code>: a boolean value that indicates if the app is free or not.</li>
  <li><code class="highlighter-rouge">stars</code>: a floating-point number between <code class="highlighter-rouge">1.0</code> and <code class="highlighter-rouge">5.0</code>, with the average score given by the users of the app.</li>
  <li><code class="highlighter-rouge">downloads</code>: a string which gives an estimate of the number of times the app has been downloaded.
  This estimate is sometimes a range, such as  <code class="highlighter-rouge">"100-1000"</code>, or <code class="highlighter-rouge">1000000+</code>.</li>
  <li><code class="highlighter-rouge">icon</code>: a string with the URL inside the Play store of the app’s icon.</li>
  <li><code class="highlighter-rouge">screenshots</code>: a list of strings, each of which is a URL to a screenshot of the Google app execution.</li>
</ul>

<p>The fields <code class="highlighter-rouge">category</code> and <code class="highlighter-rouge">categories</code> do not appear together. Here is an example of an application card:</p>

<div class="language-json highlighter-rouge"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"packageName"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"one.valid.package"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"title"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"The One Valid Package"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"free"</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
  </span><span class="nt">"stars"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mf">3.52</span><span class="p">,</span><span class="w">
  </span><span class="nt">"downloads"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"1.000.000.000 - 5.000.000.000"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"icon"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"https://lh5.ggpht.com/jZ8XCjpCQWWZ5GLhbjRA"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"categories"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="s2">"SOCIAL"</span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
</div>

<h3 id="shared-collection-card">Shared Collection Card</h3>

<p>A shared collection card contains the information about a shared collection that the backend manages.
Shared collections are stored and managed by the backend, so the endpoints can edit
the data contained within them.</p>

<p>The fields in a shared collection card are some, or all of these:</p>

<ul>
  <li><code class="highlighter-rouge">publicIdentifier</code>: a string with the public identifier of the collection.</li>
  <li><code class="highlighter-rouge">publishedOn</code>: the time and date (in <a href="https://en.wikipedia.org/wiki/Coordinated_Universal_Time">UTC</a>,
in which the collection was published. This time is written with the format <code class="highlighter-rouge">2013-11-23T05:07:13.109</code>.</li>
  <li><code class="highlighter-rouge">author</code>: a human-readable alias for the user who published the collection.</li>
  <li><code class="highlighter-rouge">category</code>: the category in which the collection falls.</li>
  <li><code class="highlighter-rouge">icon</code>: a string with the URL to the icon for this shared collection.</li>
  <li><code class="highlighter-rouge">community</code>: a boolean value to indicate if this is a community collection or not.</li>
  <li><code class="highlighter-rouge">packages</code>: a list of strings, that includes the <em>package names</em> of every app in the collection.</li>
  <li><code class="highlighter-rouge">subscriptions</code> (optional field): the number of 9 Cards’ users who have subscribed to this collection.</li>
  <li><code class="highlighter-rouge">installations</code>: the number of devices that have a shared collection installed.</li>
  <li><code class="highlighter-rouge">views</code>: the number of visits to the shared collection</li>
  <li><code class="highlighter-rouge">appsInfo</code>: a list of objects, where each object contains the information of one <code class="highlighter-rouge">apps</code> in the collection.
Each of these objects contains the fields <code class="highlighter-rouge">packageName</code>, <code class="highlighter-rouge">title</code>, <code class="highlighter-rouge">free</code>, <code class="highlighter-rouge">icon</code>, <code class="highlighter-rouge">stars</code>, <code class="highlighter-rouge">downloads</code>, and <code class="highlighter-rouge">categories</code>,
as described in <a href="#application-cards">the previous section</a>.</li>
</ul>

<p>The following is an example of this type of object:</p>

<div class="language-json highlighter-rouge"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"publicIdentifier"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"sociappathy"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"publisedOn"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-11-23T12:32:44.555"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"author"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"Jon Doe"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"name"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"Social Appathy"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"category"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"SOCIAL"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"icon"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"http://photo.blogs/url/of/icon"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"community"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
  </span><span class="nt">"installations"</span><span class="p">:</span><span class="w"> </span><span class="mi">11</span><span class="p">,</span><span class="w">
  </span><span class="nt">"subscriptions"</span><span class="p">:</span><span class="w"> </span><span class="mi">12</span><span class="p">,</span><span class="w">
  </span><span class="nt">"views"</span><span class="p">:</span><span class="w"> </span><span class="mi">13</span><span class="p">,</span><span class="w">
  </span><span class="nt">"packages"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="s2">"one.valid.package"</span><span class="p">,</span><span class="w"> </span><span class="s2">"non.existing.app"</span><span class="w"> </span><span class="p">],</span><span class="w">
  </span><span class="nt">"appsInfo"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
       </span><span class="nt">"packageName"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"one.valid.package"</span><span class="p">,</span><span class="w">
       </span><span class="nt">"title"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"The One Valid Package"</span><span class="p">,</span><span class="w">
       </span><span class="nt">"free"</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
       </span><span class="nt">"stars"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mf">3.52</span><span class="p">,</span><span class="w">
       </span><span class="nt">"downloads"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"1.000.000.000 - 5.000.000.000"</span><span class="p">,</span><span class="w">
       </span><span class="nt">"icon"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"https://lh5.ggpht.com/jZ8XCjpCQWWZ5GL"</span><span class="p">,</span><span class="w">
       </span><span class="nt">"categories"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="s2">"SOCIAL"</span><span class="p">]</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
</div>

<h3 id="shared-collection-list">Shared Collection List</h3>

<p>A shared collection list carries several shared collections, given by the backend.
As a body entity, a shared collection list is an object with a single field,
<code class="highlighter-rouge">collections</code>, which is a list of objects.
Each of these objects is a <a href="#shared-collection-card">shared collection card</a>.</p>

<div class="language-json highlighter-rouge"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"collections"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nt">"publicIdentifier"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"sociappathy"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"publisedOn"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-11-23T12:32:44.555"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"author"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
      </span><span class="nt">"name"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"Social Appathy"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"category"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"SOCIAL"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"icon"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"http://photo.blogs/url/of/icon"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"community"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
      </span><span class="nt">"subscriptions"</span><span class="p">:</span><span class="w"> </span><span class="mi">27564</span><span class="p">,</span><span class="w">
      </span><span class="nt">"packages"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="s2">"one.valid.package"</span><span class="p">,</span><span class="w"> </span><span class="s2">"non.existing.app"</span><span class="w"> </span><span class="p">],</span><span class="w">
      </span><span class="nt">"appsInfo"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="w">
           </span><span class="nt">"packageName"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"one.valid.package"</span><span class="p">,</span><span class="w">
           </span><span class="nt">"title"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"The One Valid Package"</span><span class="p">,</span><span class="w">
           </span><span class="nt">"free"</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
           </span><span class="nt">"stars"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mf">3.52</span><span class="p">,</span><span class="w">
           </span><span class="nt">"downloads"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"1.000.000.000 - 5.000.000.000"</span><span class="p">,</span><span class="w">
           </span><span class="nt">"icon"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"https://lh5.ggpht.com/jZ8XCjpCQWWZ5"</span><span class="p">,</span><span class="w">
           </span><span class="nt">"categories"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="s2">"SOCIAL"</span><span class="p">]</span><span class="w">
        </span><span class="p">}</span><span class="w">
      </span><span class="p">]</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
</div>

<h2 id="endpoints">Endpoints</h2>

<p>The specification of the endpoints follows the <code class="highlighter-rouge">REST</code> style of interfaces as a guideline.
In the description of each endpoint’s functionality, we use <em>“the client”</em> to refer
to the sender of the HTTP request, which would usually be an instance of the 9 Cards Launcher.
The response status of most endpoints, in general, will be  a <code class="highlighter-rouge">200 OK</code> status code in case of success;
or a <code class="highlighter-rouge">400 BadRequest</code> if the request is missing a needed entity body, or if this one is present but does
not fit the JSON schema outlined.</p>

<h3 id="users-and-installations">Users and installations</h3>

<p>These endpoints serve to manage the information about client instances
registered within the server, and the communication between them.</p>

<h4 id="user-signup">User Signup</h4>

<p>The <code class="highlighter-rouge">POST /login</code> endpoint signs up a client (the sender) within the backend.
Its operation reaches out to the Google API to check the identity of the client’s user account.
The request entity body must be an object with the following fields:</p>
<ul>
  <li><code class="highlighter-rouge">email</code>: a string that contains the email address of an Android user.
Its syntax should be that of an email address, and should always include the domain.</li>
  <li><code class="highlighter-rouge">androidId</code>: a string with the ID of the Android device in which the client instance is running.
Syntactically, it is an uppercase hexadecimal string.</li>
  <li><code class="highlighter-rouge">tokenId</code>: a string which contains an OAuth2 access token, issued by the Google OAuth server to the client.
The backend only uses this token for this endpoint, to check the identity of the client’s user account.
It is not stored afterward.</li>
</ul>

<p>For example, a valid request body would look like this:</p>

<div class="language-json highlighter-rouge"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"email"</span><span class="w">     </span><span class="p">:</span><span class="w"> </span><span class="s2">"jon.doe@gmail.com"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"androidId"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"1CAFE80C"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"tokenId"</span><span class="w">   </span><span class="p">:</span><span class="w"> </span><span class="s2">"k23.k1Li4iliMa_"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
</div>

<p>If successful, the body response should be an object with the following fields:</p>
<ul>
  <li><code class="highlighter-rouge">sessionToken</code>: a string containing the session token, as defined above,
that the backend uses as an alternative identity for the client.</li>
  <li><code class="highlighter-rouge">apiKey</code>: a string with the cryptographic key that the backend computes for the client.
The client uses this key to compute the value of the <code class="highlighter-rouge">X-Auth-Token</code> header for subsequent requests.</li>
</ul>

<p>Here is an example of a valid response:</p>

<div class="language-json highlighter-rouge"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"sessionToken"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"qwertyuiop90"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"apiKey"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"azerty40"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
</div>

<h4 id="update-an-installation">Update an installation</h4>

<p>The endpoint <code class="highlighter-rouge">PUT /installations</code> allows editing the <em>device token</em>  associated to the client.
This client is identified through the <a href="#client-authentication-headers">client authentication headers</a>,
which the request must provide.
The request body must be an object which may contain the optional field <code class="highlighter-rouge">deviceToken</code>.
This field’s value is either a string, or <code class="highlighter-rouge">null</code>. Thus, each of these is a valid body:</p>

<div class="language-json highlighter-rouge"><pre class="highlight"><code><span class="p">{</span><span class="w"> </span><span class="nt">"deviceToken"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"tokentoken"</span><span class="w"> </span><span class="p">}</span><span class="w">
</span><span class="p">{</span><span class="w"> </span><span class="nt">"deviceToken"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="w"> </span><span class="p">}</span><span class="w">
</span><span class="p">{}</span><span class="w">
</span></code></pre>
</div>

<p>The action of this endpoint is to modify the <code class="highlighter-rouge">deviceToken</code> associated to the client.
If the <code class="highlighter-rouge">deviceToken</code> field in the request is a string, then this value replaces the previous one.
If it is <code class="highlighter-rouge">null</code>, or the field is missing, then the client is left with no <code class="highlighter-rouge">deviceToken</code>.</p>

<p>If successful, the response body is an object that contains two fields:
the <code class="highlighter-rouge">androidId</code> of the client that issued the request,
and the <code class="highlighter-rouge">deviceToken</code> which that client has been assigned to.
For instance, a valid response would be the following one:</p>

<div class="language-json highlighter-rouge"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"androidId"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"1CAFE80C"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"deviceToken"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"tokentoken"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
</div>

<p>The response status for this endpoint can be <code class="highlighter-rouge">200 OK</code>, if the request was correct and it was processed correctly;
or <code class="highlighter-rouge">401 Unauthorized</code> if there was a <a href="#client-authentication-failure">client authentication failure</a>.</p>

<h3 id="application-endpoints">Application endpoints</h3>

<p>These endpoints are used for querying data about Android apps, irrespective of the
shared collections in which they may appear.</p>

<h4 id="categorize-apps">Categorize apps</h4>

<p>The <code class="highlighter-rouge">POST /applications/categorize</code> endpoint takes a list of app <em>package names</em>,
classifies them by each app’s main categories, and reports for which apps it could
not find the category.
The request must include the <a href="#client-authentication-headers">client authentication headers</a>
and the <a href="#google-play-token-header">Google Play Token Header</a>.
The request body must be an object with one field <code class="highlighter-rouge">items</code>, whose value is a list of strings.
Each one is a <em>package name</em>. An example would be the following one:</p>

<div class="language-json highlighter-rouge"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"items"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="s2">"com.google.android.youtube"</span><span class="p">,</span><span class="w"> </span><span class="s2">"package.which.does.not.exists"</span><span class="w"> </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
</div>

<p>If successful, the response body should be an object with the following fields:</p>
<ul>
  <li><code class="highlighter-rouge">errors</code>: a list of strings, each of them a <em>package names</em> from the request body.
This list contains the names of the apps which could not be categorized.</li>
  <li><code class="highlighter-rouge">items</code>: a list of objects, each of which corresponds to an Android app that was successfully
categorized. Each object has two fields, <code class="highlighter-rouge">packageName</code> and <code class="highlighter-rouge">category</code>, which are as described
<a href="#application-cards">above</a>. The <code class="highlighter-rouge">packageName</code> must be one listed in the request body.</li>
</ul>

<p>An example would be the following response:</p>

<div class="language-json highlighter-rouge"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"errors"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="s2">"package.which.does.not.exists"</span><span class="w"> </span><span class="p">],</span><span class="w">
  </span><span class="nt">"items"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
     </span><span class="p">{</span><span class="w">
       </span><span class="nt">"packageName"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"com.google.android.youtube"</span><span class="p">,</span><span class="w">
       </span><span class="nt">"category"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"VIDEO_PLAYERS"</span><span class="w">
     </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
</div>
<p>Failure to categorize an app might occur because the Google Play token is unauthorized, or its
quota is exhausted. It may also be because a package name is not an app.
It may also be an app bundled by some Android vendors, which is not published in the Play Store.
These failures do not affect the response status for this endpoint.
The response status  can be <code class="highlighter-rouge">200 OK</code>, if the request was correct and it could be processed;
or <code class="highlighter-rouge">401 Unauthorized</code>, either because of <a href="#client-authentication-failure">wrong client authentication</a>
or because the <a href="#google-play-token-header">Google Play Token Header</a> is missing.</p>

<h4 id="get-apps-details">Get Apps Details</h4>

<p>The <code class="highlighter-rouge">POST /applications/details</code> endpoint takes a list of app <em>package names</em>
and for each app, it gives back a <em>card</em> with the details about that app.
It also reports those apps for which it could not find details.
The request must include the <a href="#client-authentication-headers">client authentication headers</a>
and the <a href="#google-play-token-header">Google Play Token Header</a>.
The body should be an object with a single field <code class="highlighter-rouge">items</code>,
whose value is a list of strings. Each string is the <em>package name</em> of an Android app.
The following is an example:</p>

<div class="language-json highlighter-rouge"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"items"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="s2">"com.google.android.youtube"</span><span class="p">,</span><span class="w"> </span><span class="s2">"package.which.does.not.exists"</span><span class="w"> </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
</div>

<p>If successful, the response body is an object with two fields:</p>
<ul>
  <li><code class="highlighter-rouge">errors</code>: a list of strings, each one being one of the <em>package names</em>
from the <code class="highlighter-rouge">items</code> field in the request body. This list contains the names of the apps for which it could not locate details.</li>
  <li><code class="highlighter-rouge">items</code>: a list of objects, where each object contains some of the details of an Android app.
These objects contain the fields <code class="highlighter-rouge">packageName</code>, <code class="highlighter-rouge">title</code>, <code class="highlighter-rouge">free</code>, <code class="highlighter-rouge">stars</code>, <code class="highlighter-rouge">downloads</code>, <code class="highlighter-rouge">icon</code>,
and <code class="highlighter-rouge">categories</code>, which are as described in the section for <a href="#application-cards">application cards</a>.
Note that the value of <code class="highlighter-rouge">packageName</code> should be one of the packages listed in the request body.</li>
</ul>

<p>Here is an example response:</p>

<div class="language-json highlighter-rouge"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"errors"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="s2">"package.which.does.not.exists"</span><span class="w"> </span><span class="p">],</span><span class="w">
  </span><span class="nt">"items"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nt">"packageName"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"com.google.android.youtube"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"title"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"Youtube"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"free"</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
      </span><span class="nt">"stars"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mf">4.231</span><span class="p">,</span><span class="w">
      </span><span class="nt">"downloads"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"1.000.000.000 - 5.000.000.000"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"icon"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"https://lh5.ggpht.com/jZ8XCjpCQWWZ5GLh"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"categories"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="s2">"VIDEO_PLAYERS"</span><span class="p">]</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
</div>

<p>These failures do not affect the response status for this endpoint. This status can be
 <code class="highlighter-rouge">200 OK</code>, if the request was correct and it could be processed;
or  <code class="highlighter-rouge">401 Unauthorized</code>, either because of wrong <a href="#client-authentication-failure">client auth headers</a>,
or because the <a href="#google-play-token-header">Google Play Token Header</a> is missing.</p>

<h4 id="get-ranking-of-applications">Get Ranking of Applications</h4>

<p>The <code class="highlighter-rouge">POST /applications/rank</code> endpoint takes several lists of package names as input,
and returns each list with the apps sorted according to the app’s popularity
amongst users of 9 Cards.</p>

<p>The request must include the <a href="#client-authentication-headers">client authentication headers</a>.
The request body must be an object with two fields:</p>
<ul>
  <li><code class="highlighter-rouge">location</code>: an optional string which gives the geographic location of the client,
by giving the <a href="https://en.wikipedia.org/wiki/ISO_3166-1_alpha-2 ISO-2">two-letter code</a> of the country in which the client device is located. This is used to choose a ranking with a geographic scope
(country, continent) that better fits the client.</li>
  <li><code class="highlighter-rouge">items</code>: an object that contains the lists of apps. Each of the fields in this object corresponds to a category, so the field key is the name of the category. The value of the field is the list of app package names that are to be ranked within that category.</li>
</ul>

<p>Here is an example of this body entity:</p>

<div class="language-json highlighter-rouge"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"location"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"ES"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"items"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"SOCIAL"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="s2">"com.facebook"</span><span class="p">,</span><span class="w"> </span><span class="s2">"com.twitter"</span><span class="p">],</span><span class="w">
    </span><span class="nt">"VIDEO_PLAYER"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"com.youtube"</span><span class="p">,</span><span class="w"> </span><span class="s2">"com.vimeo"</span><span class="p">]</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
</div>

<p>If successful, the response body is an object with a single field <code class="highlighter-rouge">items</code>. The value of this field
is an object like the request, whose keys are the categories, and whose values are the lists of app
package names, sorted by ranking from most valued to least valued by the users of 9 Cards.</p>

<div class="language-json highlighter-rouge"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"items"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"SOCIAL"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="s2">"com.facebook"</span><span class="p">,</span><span class="w"> </span><span class="s2">"com.twitter"</span><span class="p">],</span><span class="w">
    </span><span class="nt">"VIDEO_PLAYER"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"com.vimeo"</span><span class="p">,</span><span class="w"> </span><span class="s2">"com.youtube"</span><span class="p">]</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
</div>

<h3 id="recommendation-endpoints">Recommendation Endpoints</h3>

<p>These endpoints are used by the client to search for more apps that may be of interest to the client’s user.
In these endpoints, the backend is not using any information of its own regarding collections
or rankings. It’s just acting as an intermediary and cache for these results.</p>

<h4 id="recommend-by-list-of-apps">Recommend by list of apps</h4>

<p>The endpoint <code class="highlighter-rouge">POST /recommendations</code> can be used to recommend a client a list of
apps to install, based on those already installed.
The request must include the <a href="#client-authentication-headers">client authentication headers</a>
and the <a href="#google-play-token-header">Google Play Token Header</a>.
The request body must be an object with the following fields:</p>
<ul>
  <li><code class="highlighter-rouge">packages</code>: a list of strings, each of them a package name. These are the
 apps which are to be used as a reference for the recommendations.</li>
  <li><code class="highlighter-rouge">excludePackages</code>: a list of strings, each of them a package name. These are the packages
that should not appear in the list of recommendations in the response.</li>
  <li><code class="highlighter-rouge">limitPerApp</code>: an integer number, which says how many related packages should be
explored for each of the apps in <code class="highlighter-rouge">packages</code>.</li>
  <li><code class="highlighter-rouge">limit</code>: an integer number, that sets the maximum number of recommended elements
in the response.</li>
</ul>

<p>Here is an example of a request body:</p>

<div class="language-json highlighter-rouge"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"packages"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="s2">"one.package.lamp"</span><span class="p">,</span><span class="w"> </span><span class="s2">"two.package.cat"</span><span class="p">],</span><span class="w">
  </span><span class="nt">"excludePackages"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="s2">"the.bad.package"</span><span class="p">,</span><span class="w"> </span><span class="s2">"once.upon.time"</span><span class="p">],</span><span class="w">
  </span><span class="nt">"limitPerApp"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w">
  </span><span class="nt">"limit"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">20</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
</div>

<p>If this endpoint succeeds, then the response entity is an object with the only field
<code class="highlighter-rouge">items</code>, which is a list of objects that represent the recommended apps.
Each object has the fields <code class="highlighter-rouge">packageName</code>, <code class="highlighter-rouge">title</code>, <code class="highlighter-rouge">free</code>, <code class="highlighter-rouge">icon</code>, <code class="highlighter-rouge">stars</code>, <code class="highlighter-rouge">downloads</code>,
and <code class="highlighter-rouge">screenshots</code>, as described in the <a href="#application-cards">app card section</a>.
Here is an example of the response:</p>

<div class="language-json highlighter-rouge"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"items"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nt">"packageName"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"one.valid.package"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"title"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"The One Valid Package"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"free"</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
      </span><span class="nt">"stars"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mf">3.52</span><span class="p">,</span><span class="w">
      </span><span class="nt">"downloads"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"1.000.000.000 - 5.000.000.000"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"icon"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"https://lh5.ggpht.com/icon999999"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"categories"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="s2">"SOCIAL"</span><span class="p">]</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
</div>

<p>The response status for this endpoints can be
<code class="highlighter-rouge">200 OK</code>,  if the request was correct and it could be processed; or
or  <code class="highlighter-rouge">401 Unauthorized</code>, either because of wrong <a href="#client-authentication-failure">client auth headers</a>,
or because the <a href="#google-play-token-header">Google Play Token Header</a> is missing.</p>

<h4 id="recommend-by-category">Recommend by category</h4>

<p>The <code class="highlighter-rouge">POST /recommendations/{category}/{priceFilter}</code> endpoint is used to recommend a list of apps to install for a particular category to a client.
The endpoints take two parameters as path segments:</p>
<ul>
  <li><code class="highlighter-rouge">category</code>, the category in which to look for recommended apps; and</li>
  <li><code class="highlighter-rouge">priceFilter</code>, which can be one of <code class="highlighter-rouge">FREE</code>, <code class="highlighter-rouge">PAID</code>, or <code class="highlighter-rouge">ALL</code>, which filters the
recommendations to include only free, paid, or all apps.</li>
</ul>

<p>The request must include the <a href="#client-authentication-headers">client authentication headers</a>
and the <a href="#google-play-token-header">Google Play Token Header</a>.
The request body should be an object with two fields, <code class="highlighter-rouge">excludePackages</code> and <code class="highlighter-rouge">limit</code>,
which are just like the ones described for <a href="recommend-by-list-of-apps">the previous endpoint</a>.</p>

<p>Here is a request body example:</p>

<div class="language-json highlighter-rouge"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"excludePackages"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="s2">"the.bad.package"</span><span class="p">,</span><span class="w"> </span><span class="s2">"once.upon.time"</span><span class="p">],</span><span class="w">
  </span><span class="nt">"limit"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">20</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
</div>

<p>If successful, the response entity is just like that of the
<a href="#recommend-by-list-of-apps">previous endpoint</a>.
The response status for this endpoint can be
<code class="highlighter-rouge">200 OK</code>,  if the request was correct and it could be processed; or
<code class="highlighter-rouge">404 NotFound</code>, if either the <code class="highlighter-rouge">category</code> is not a valid category name
or the  <code class="highlighter-rouge">priceFilter</code> is other that <code class="highlighter-rouge">FREE</code>, <code class="highlighter-rouge">PAID</code>, <code class="highlighter-rouge">ALL</code>;
or <code class="highlighter-rouge">401 Unauthorized</code>, either because of wrong <a href="#client-authentication-failure">client auth headers</a>,
or because the <a href="#google-play-token-header">Google Play Token Header</a> is missing.</p>

<h3 id="collection-endpoints">Collection endpoints</h3>

<h4 id="publish-a-shared-collection">Publish a shared collection</h4>

<p>The <code class="highlighter-rouge">POST /collections</code> serves to publish a new shared collection, whose author is the client’s user.
The request must include the <a href="#client-authentication-headers">client authentication headers</a>.
The body entity of the request should be an object with the information about the new collection.
This object is a reduced version of a <a href="#shared-collection-card">shared collection card</a>,
restricted to the fields  <code class="highlighter-rouge">author</code>, <code class="highlighter-rouge">name</code>, <code class="highlighter-rouge">installations</code>, <code class="highlighter-rouge">views</code>, <code class="highlighter-rouge">category</code>, <code class="highlighter-rouge">icon</code>,
<code class="highlighter-rouge">community</code>, and <code class="highlighter-rouge">packages</code>, only. Of these, <code class="highlighter-rouge">views</code> and <code class="highlighter-rouge">installations</code> are optional fields.</p>

<p>Here is an example of this body request:</p>

<div class="language-json highlighter-rouge"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"author"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"Jon Doe"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"name"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"Social Appathy"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"category"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"SOCIAL"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"icon"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"http://photo.blogs/url/of/icon"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"community"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
  </span><span class="nt">"installations"</span><span class="p">:</span><span class="w"> </span><span class="mi">11</span><span class="p">,</span><span class="w">
  </span><span class="nt">"views"</span><span class="p">:</span><span class="w"> </span><span class="mi">13</span><span class="p">,</span><span class="w">
  </span><span class="nt">"packages"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="s2">"one.valid.package"</span><span class="p">,</span><span class="w"> </span><span class="s2">"non.existing.app"</span><span class="w"> </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
</div>

<p>If successful, the response body is an object with two fields:</p>
<ul>
  <li><code class="highlighter-rouge">publicIdentifier</code>: a string, with the public identifier of the new collection, as given to it by the backend.</li>
  <li><code class="highlighter-rouge">packageStats</code>: an object with a single field <code class="highlighter-rouge">added</code>, which is the number of packages added to the collection.</li>
</ul>

<p>The response status of this endpoint can be <code class="highlighter-rouge">200 OK</code> if it was successful; or <code class="highlighter-rouge">401 Unauthorized</code>, if there is a
<a href="#client-authentication-failure">client authentication failure</a>; or <code class="highlighter-rouge">400 BadRequest</code> if the request body is malformed.</p>

<h4 id="read-a-collection">Read a collection</h4>

<p>The endpoint <code class="highlighter-rouge">GET /collections/{collectionId}</code> gets all the information about a shared collection,
whose public identifier is passed in the <code class="highlighter-rouge">collectionId</code> segment.
The request must include the <a href="#client-authentication-headers">client authentication headers</a>
and the <a href="#google-play-token-header">Google Play Token Header</a>.</p>

<p>If successful, the response body is an object, whose fields are those of a
<a href="#application-cards"><em>shared collection</em> card</a>. Note that the <code class="highlighter-rouge">publicIdentifier</code> field
in this card should be identical to the <code class="highlighter-rouge">collectionId</code> path segment.
See <a href="#application-cards">an example of a response from this endpoint</a></p>

<p>The response status can be  <code class="highlighter-rouge">200 OK</code> if the shared collection exists;
or  <code class="highlighter-rouge">404 NotFound</code>, if there is no collection with the given <code class="highlighter-rouge">collectionId</code>;
or <code class="highlighter-rouge">401 Unauthorized</code>, either because of wrong <a href="#client-authentication-failure">client auth headers</a>,
 or because the <a href="#google-play-token-header">Google Play Token Header</a> is missing.</p>

<h4 id="edit-a-collection">Edit a collection</h4>

<p>The <code class="highlighter-rouge">PUT /collections/{collectionId}</code> endpoint serves to edit the data of the collection
whose <code class="highlighter-rouge">publicIdentifier</code> is given by the <code class="highlighter-rouge">collectionId</code> path segment.
This can only be done if the collection was published by the client’s user.
The request must include the <a href="#client-authentication-headers">client authentication headers</a>.
The body entity should be an object with two fields:</p>
<ul>
  <li><code class="highlighter-rouge">collectionInfo</code> (optional field): an object with a single field <code class="highlighter-rouge">title</code>.</li>
  <li><code class="highlighter-rouge">packages</code>: a list of strings, each of which is a <em>package name</em>, which gives the new set of
applications contained in the collection.</li>
</ul>

<p>Here is an example of the request body, for a call to <code class="highlighter-rouge">PUT /collections/sociappathy</code>,</p>

<div class="language-json highlighter-rouge"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"collectionInfo"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nt">"title"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"More Social Appathy"</span><span class="p">},</span><span class="w">
  </span><span class="nt">"packages"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="s2">"com.twitter"</span><span class="p">,</span><span class="w"> </span><span class="s2">"com.facebook"</span><span class="w"> </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
</div>

<p>If successful, the response body is an object with two fields:</p>
<ul>
  <li><code class="highlighter-rouge">publicIdentifier</code>: a string exactly equal to the <code class="highlighter-rouge">collectionId</code> segment.</li>
  <li><code class="highlighter-rouge">packageStats</code>: an object which counts the number of changes in the collection list of applications.
This object has up to two fields: <code class="highlighter-rouge">added</code>, an integer number that counts how many packages were added to the collection,
and the optional field <code class="highlighter-rouge">removed</code>, another integer number that counts how many packages were removed.
Here is an example of the response body:</li>
</ul>

<div class="language-json highlighter-rouge"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"publicIdentifier"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"sociappathy"</span><span class="w"> </span><span class="p">,</span><span class="w">
  </span><span class="nt">"packageStats"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nt">"added"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="nt">"removed"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
</div>

<p>The response status can be</p>
<ul>
  <li><code class="highlighter-rouge">200 OK</code> if the request could be performed.</li>
  <li><code class="highlighter-rouge">401 Unauthorized</code> if there is a <a href="#client-authentication-failure">client authentication failure</a>.</li>
  <li><code class="highlighter-rouge">403 Forbidden</code> if the client is authenticated, but is not the author of the collection.</li>
  <li><code class="highlighter-rouge">404 NotFound</code> if there is no collection whose public identifier is the <code class="highlighter-rouge">collectionId</code> given in a path param.</li>
</ul>

<h4 id="collections-published-by-user">Collections published by user</h4>

<p>This endpoint, <code class="highlighter-rouge">GET /collections</code>, gives the list of collections published by the client user.
The request must include the <a href="#client-authentication-headers">client authentication headers</a>
and the <a href="#google-play-token-header">Google Play Token Header</a>.
If successful, the response entity is a <a href="#shared-collection-list">shared collection list</a>.
The response status can be one of the following:</p>
<ul>
  <li><code class="highlighter-rouge">200 OK</code> if the request could be performed.</li>
  <li><code class="highlighter-rouge">401 Unauthorized</code> if there is a <a href="#client-authentication-failure">client authentication failure</a>.</li>
</ul>

<h4 id="list-of-collections-by-category">List of collections by category</h4>

<p>The endpoints <code class="highlighter-rouge">GET /collections/{sort}/{category}/{pageNumber}/{pageSize}</code> are used to
obtain a list of shared collections within a category, sorted according to a criterion of interest,
and paginated. The endpoint takes the following path segments as parameters:</p>
<ul>
  <li>The <code class="highlighter-rouge">sort</code> parameter indicates the order in which to sort the collections. It can be one of the following:
..* <code class="highlighter-rouge">latest</code>, to sort collections from most recently to least recently published.
..* <code class="highlighter-rouge">top</code>, to sort collections from most downloaded to least downloaded.</li>
  <li>The <code class="highlighter-rouge">category</code> parameter indicates the category in which we look for collections.</li>
  <li>The <code class="highlighter-rouge">pageSize</code> is the number of elements in each page.</li>
  <li>The <code class="highlighter-rouge">pageNumber</code> is the number of the page that is retrieved.</li>
</ul>

<p>The request must include the <a href="#client-authentication-headers">client authentication headers</a>
and the <a href="#google-play-token-header">Google Play Token Header</a>.
If successful, the response body is a <a href="#shared-collection-list">shared collection list</a>.
The response status for this endpoint can be one of the following:</p>
<ul>
  <li><code class="highlighter-rouge">200 OK</code> if the request is successful.</li>
  <li><code class="highlighter-rouge">401 Unauthorized</code> if the client authentication headers are wrong or missing.</li>
  <li><code class="highlighter-rouge">404 NotFound</code> if the <code class="highlighter-rouge">category</code> path segment corresponds to no category,
  or if the <code class="highlighter-rouge">sort</code> path segment is other than <code class="highlighter-rouge">latest</code> or <code class="highlighter-rouge">top</code>.</li>
</ul>

<h3 id="subscription-endpoints">Subscription endpoints</h3>

<p>These endpoints are used to manage the subscription relation between the client and those collections
published by other users. All of these endpoints require the
<a href="#client-authentication-headers">client authentication headers</a> from the request,
and fail with a <code class="highlighter-rouge">401 Unauthorized</code> <a href="#client-authorization-failure">if they fail</a>.</p>

<h4 id="list-of-subscribed-collections">List of subscribed collections</h4>

<p>The <code class="highlighter-rouge">GET /collections/subscriptions</code> endpoint gives back a list of public collections
that the client’s user is subscribed to.
The request must include the <a href="#client-authentication-headers">client authentication headers</a>.
If successful, the response is a list of strings, each of which is the public identifier of
one of the collections the user is subscribed to.</p>

<p>An example of a body response would be:</p>

<div class="language-json highlighter-rouge"><pre class="highlight"><code><span class="p">[</span><span class="w"> </span><span class="s2">"one.pack.age"</span><span class="p">,</span><span class="w"> </span><span class="s2">"two.pack.age"</span><span class="w"> </span><span class="p">]</span><span class="w">
</span></code></pre>
</div>

<p>The response status can be one of the following:</p>
<ul>
  <li><code class="highlighter-rouge">200 OK</code> if the shared collection exists, in which case the user has been unsubscribed (if it was).</li>
  <li><code class="highlighter-rouge">401 Unauthorized</code> if there is a <a href="#client-authentication-failure">client authentication failure</a>.</li>
</ul>

<h4 id="subscribe-to-a-shared-collection">Subscribe to a shared collection</h4>

<p>The <code class="highlighter-rouge">PUT /collections/subscriptions/{collectionId}</code> endpoint subscribes the client’s user
to the public shared collection whose public identifier is given in the <code class="highlighter-rouge">collectionId</code> path segment.
The request must include the <a href="#client-authentication-headers">client authentication headers</a>.
The endpoint takes no request entity body. If it succeeds, it produces an empty object <code class="highlighter-rouge"><span class="p">{}</span></code> in the response body.
The response status can be one of the following:</p>
<ul>
  <li><code class="highlighter-rouge">200 OK</code> if the shared collection exists, in which case the user has been unsubscribed (if it was)</li>
  <li><code class="highlighter-rouge">401 Unauthorized</code> if any of the headers for client authentication is missing.</li>
  <li><code class="highlighter-rouge">404 NotFound</code> if there is no collection with the given <code class="highlighter-rouge">collectionId</code>.</li>
</ul>

<h4 id="unsubscribe-from-a-shared-collection">Unsubscribe from a shared collection</h4>

<p>The  <code class="highlighter-rouge">DELETE /collections/subscriptions/{collectionId}</code> endpoint unsubscribes the sender
from the public collection whose public identifier is given by the <code class="highlighter-rouge">collectionId</code> path segment.
The endpoint requires  the <a href="#client-authentication-headers">client authentication headers</a>.
If it succeeds, it produces an empty object <code class="highlighter-rouge"><span class="p">{}</span></code> in the response body.
The response status can be one of the following:</p>
<ul>
  <li><code class="highlighter-rouge">200 OK</code> if the shared collection exists, in which case the user has been unsubscribed (if they were).</li>
  <li><code class="highlighter-rouge">401 Unauthorized</code> if there is a <a href="#client-authentication-failure">client authentication failure</a>.</li>
  <li><code class="highlighter-rouge">404 NotFound</code> if there isn’t a collection with the given <code class="highlighter-rouge">collectionId</code>.</li>
</ul>

<h3 id="rankings-endpoints">Rankings Endpoints</h3>

<p>These endpoints allow for reading and refreshing the rankings that the backend collects
from the Google Analytics API, irrespective of the apps in the client.
These are special endpoints, in that they’re not used by a client, but by the
management of the backend. For this reason, they do <em>not</em> require the
<a href="#client-authentication-headers">client authentication headers</a>.</p>

<p>With these endpoints, we use a path segment to indicate the geographic scope of the ranking.
This geographic scope can be one of the following:</p>
<ul>
  <li>The whole world, which is represented as the path prefix <code class="highlighter-rouge">/world</code>.</li>
  <li>A continent, which is expressed as the path segments <code class="highlighter-rouge">/continents/{cont}</code>, where <code class="highlighter-rouge">cont</code>
can be one of <code class="highlighter-rouge">Africa</code>, <code class="highlighter-rouge">Americas</code>, <code class="highlighter-rouge">Oceania</code>, <code class="highlighter-rouge">Europe</code> or <code class="highlighter-rouge">Asia</code>.</li>
  <li>A country, which is expressed as the path segments <code class="highlighter-rouge">/countries/{count}</code>, where <code class="highlighter-rouge">count</code> is the name
of a country supported by the backend.
At present, we only support <code class="highlighter-rouge">Spain</code>, <code class="highlighter-rouge">United_Kingdom</code>, and <code class="highlighter-rouge">United_States</code>.</li>
</ul>

<h4 id="read-a-ranking">Read a Ranking</h4>

<p>The <code class="highlighter-rouge">GET /rankings/{geographic}</code> endpoints provide the full list of rankings for a geographic scope.
This endpoint doesn’t need any special headers.
If successful, the response body entity is an object with a single field, <code class="highlighter-rouge">categories</code>,
whose value is a list of objects. Each of these objects is the ranking for a given category.
Its fields are:</p>
<ul>
  <li><code class="highlighter-rouge">category</code>: a string with the name of the category.</li>
  <li><code class="highlighter-rouge">apps</code>: a list of app package names, ordered by ranking (first position to the last position).</li>
  <li>Here is an example of this response:</li>
</ul>

<div class="language-json highlighter-rouge"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"categories"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nt">"category"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"SOCIAL"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"apps"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="s2">"com.facebook"</span><span class="p">,</span><span class="w"> </span><span class="s2">"com.twitter"</span><span class="w"> </span><span class="p">]</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nt">"category"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"GAME_ARCADE"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"apps"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="err">"old.games.doom</span><span class="p">]</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
</div>

<p>The response status can be <code class="highlighter-rouge">200 OK</code> if it succeeds; or <code class="highlighter-rouge">404 NotFound</code>, if the geographic scope
does not correspond to one of those  <a href="#rankings-endpoints">described above</a>.</p>

<h4 id="refresh-a-ranking">Refresh a Ranking</h4>
<p>The <code class="highlighter-rouge">POST /rankings/{geographic}</code> endpoints serve to refresh the rankings for the given geographic scope.</p>

<p>This endpoint requires a special <code class="highlighter-rouge">X-Google-Analytics-Token</code>, whose value carries the OAuth2 token
that grants the backend server access to the Google Analytics Report that collects the statistics
on 9 Cards users, from which the rankings are made.</p>

<p>The entity body in the request must be an object with the following three fields:</p>
<ul>
  <li><code class="highlighter-rouge">startDate</code>: a string that gives the start day from which we start the analytics sample.
Syntactically, it has the format <code class="highlighter-rouge">"yyyy-MM-dd"</code>, which gives the number of the year, the number of the month,
and the number of the day of the month, for the desired date.</li>
  <li><code class="highlighter-rouge">endDate</code>: a string, much like the <code class="highlighter-rouge">startDate</code>, that gives the end day of the sample period.
Syntactically, it is like the <code class="highlighter-rouge">startDate</code> field.</li>
  <li><code class="highlighter-rouge">rankingLength</code>: an integer number which gives the number of applications that each category’s ranking should have <em>at most</em>.
These applications, of course, would be the most valued.</li>
</ul>

<p>The following is an example of this request:</p>

<div class="language-json highlighter-rouge"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"startDate"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"2016-01-31"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"endDate"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"2016-03-21"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"rankingLength"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
</div>

<p>If successful, the endpoint returns an empty object <code class="highlighter-rouge"><span class="p">{}</span></code>. If there is a failure in the
execution of the endpoint, it returns an object with these fields:</p>
<ul>
  <li><code class="highlighter-rouge">error</code>: a number with the status code of the error.</li>
  <li><code class="highlighter-rouge">message</code>: a message with the error.</li>
  <li><code class="highlighter-rouge">status</code>: a string describing the reason for the error.</li>
</ul>

<p>The response status can be <code class="highlighter-rouge">200 OK</code> if it succeeds, or <code class="highlighter-rouge">404 NotFound</code>, if the geographic scope
does not correspond to one of those  <a href="#rankings-endpoints">described above</a>.
The response can be <code class="highlighter-rouge">400 BadRequest</code> if the dates in the request are wrong,
either because one is a wrong date (such as <code class="highlighter-rouge">"2016-02-30"</code>),
or because the <code class="highlighter-rouge">endDate</code> precedes the <code class="highlighter-rouge">startDate</code>,
or because the <code class="highlighter-rouge">startDate</code> precedes the launch of Google Analytics.</p>
</section></div></div></div></div><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js"></script><script src="/nine-cards-v2/highlight/highlight.pack.js"></script><script>hljs.configure({
languages:['scala','java','bash']
});
hljs.initHighlighting();
             </script><script src="/nine-cards-v2/js/main.js"></script></body></html>